From d170f8cdd25f951d1018d23d689622efd6f3b244 Mon Sep 17 00:00:00 2001
From: Rokis <ghost1988102@gmail.com>
Date: Mon, 13 Apr 2020 01:15:15 +0800
Subject: [PATCH 005/122] =?UTF-8?q?=E6=B7=BB=E5=8A=A0K3=E7=9A=84GPIO?=
 =?UTF-8?q?=EF=BC=8C=E4=BF=AE=E5=A4=8DTTL=E4=B8=8B=E6=8F=90=E7=A4=BA"butto?=
 =?UTF-8?q?n=20RESET=20pressed"=E7=9A=84=E9=97=AE=E9=A2=98=20Add=20K3=20gp?=
 =?UTF-8?q?io=20in=20order=20to=20shut=20down=20the=20noisy=20log=20"butto?=
 =?UTF-8?q?n=20RESET=20pressed".?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Rokis <ghost1988102@gmail.com>
---
 release/src/router/rc/init.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/release/src/router/rc/init.c b/release/src/router/rc/init.c
index fc8c0a76ad..dfcbb1dc03 100644
--- a/release/src/router/rc/init.c
+++ b/release/src/router/rc/init.c
@@ -11397,6 +11397,7 @@ int init_nvram(void)
 #endif
 		/* gpio */
 		/* HW reset, 2 | LOW */
+#ifndef RTK3
 		nvram_set_int("led_pwr_gpio", 3|GPIO_ACTIVE_LOW);
 #ifdef RTCONFIG_LED_BTN
 		nvram_set_int("btn_led_gpio", 4|GPIO_ACTIVE_LOW);
@@ -11427,6 +11428,11 @@ int init_nvram(void)
 		nvram_set_int("led_lan_gpio", 21|GPIO_ACTIVE_LOW);	/* FAN CTRL: reserved */
 		/* PA 5V/3.3V switch, 22 */
 		/* SDIO_EN_1P8, 23 | HIGH */
+#else
+		nvram_set_int("btn_rst_gpio", 17|GPIO_ACTIVE_LOW);
+		nvram_set_int("pwr_usb2_gpio", 18|GPIO_ACTIVE_LOW);
+		nvram_set_int("pwr_usb_gpio", 21|GPIO_ACTIVE_LOW);
+#endif
 
 #ifdef RTCONFIG_XHCIMODE
 		nvram_set("xhci_ports", "1-1");
@@ -11447,7 +11453,11 @@ int init_nvram(void)
 
 		if (!nvram_get("ct_max"))
 			nvram_set("ct_max", "300000");
+#ifdef RTK3
+		add_rc_support("mssid 2.4G 5G usbX1");
+#else
 		add_rc_support("mssid 2.4G 5G usbX2");
+#endif
 #ifdef RTCONFIG_MERLINUPDATE
 		add_rc_support("update");
 #else
-- 
2.25.1

